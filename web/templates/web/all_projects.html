{% extends 'web/base.html' %}
{% block content %}
{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
{% endif %}
    <form action="">
        <b>–§–∏–ª—å—Ç—Ä—ã:</b><br>
        {% for field in filter_form %}
            {{field}}
        {% endfor %}
        <button>–ù–∞–π—Ç–∏</button>
        <a href="?">–û—á–∏—Å—Ç–∏—Ç—å</a>
    </form>

    {% if user.role == 'manager' %}
        <br>
        <p><a href="{% url 'add_project' %}">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</a></p>
    {% endif %}

    <div class="dashboard">
        <div class="dashboard-section">
            <div class="section-title">–ü—Ä–æ–µ–∫—Ç—ã</div>
            <div class="card-list">
                {% for project in projects %}
                    <div class="card project {% if project.is_done %}done{% endif %}" onclick="location.href='{% url 'current_project' project.id %}'">
                        <div class="card-title">{{ project.title }}</div>
                        <div class="card-info">
                            <span class="icon">üìÖ</span>{{ project.date_create|date:"d/m/Y" }}
                            <span class="icon">‚è∞</span>{{ project.deadline|date:"d/m/Y" }}
                            <span class="icon">üë•</span>
                            {% for emp in project.employees.all %}
                                {{ emp.fio }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                {% empty %}
                    <div class="text-muted">–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç.</div>
                {% endfor %}
            </div>
        </div>
    </div>

    <nav>
        {% if tasks.has_previous %}
            <a href="?page=1">–í –Ω–∞—á–∞–ª–æ</a>
            <a href="?page={{tasks.previous_page_number}}">–ü—Ä–µ–¥—ã–¥—É—à–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a>
        {% endif %}

        –ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤:
        {% if total_count > 0%}
            <b>{{total_count}}</b> <br>
        {% else %}
            <b>0</b><br>
        {% endif %}

        {% if tasks.paginator.count > 0  %}
            c—Ç—Ä–∞–Ω–∏—Ü–∞ {{ tasks.number }} –∏–∑ {{tasks.paginator.num_pages}}
        {% else %}
            —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1
        {% endif %}

        {% if tasks.has_next %}
            <a href="?page={{tasks.next_page_number}}">–í –∫–æ–Ω–µ—Ü</a>
            <a href="?page={{tasks.paginator.num_pages}}">–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a>
        {% endif %}
    </nav>

{% endblock %}